<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Retail Net-Zero — Solar + PPA (CORE Markets)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="color-scheme" content="light dark" />

  <!-- Dynamic <base> so /foo and foo resolve to /REPO/path/foo on GitHub Pages -->
  <script>
    (function () {
      var path = window.location.pathname.replace(/\/+$/, '');
      var parts = path.split('/').filter(Boolean);
      // For project sites: /USERNAME/REPO/... ; for profile/custom domains: /
      var baseHref = (parts.length >= 2) ? ('/' + parts[0] + '/' + parts[1] + '/') : '/';
      var base = document.createElement('base');
      base.href = baseHref;
      document.head.prepend(base);
    })();
  </script>

  <style>
    :root{
      --bg:#ffffff; --fg:#0f172a; --muted:#475569; --card:#f8fafc; --border:#e2e8f0;
      --accent:#2563eb; --accent-fg:#ffffff; --shadow:0 6px 24px rgba(15,23,42,.08),0 2px 8px rgba(15,23,42,.06);
      --maxw: 960px;
    }
    @media (prefers-color-scheme: dark){
      :root{ --bg:#0b1220; --fg:#e5e7eb; --muted:#94a3b8; --card:#111827; --border:#1f2937; --accent:#60a5fa; --accent-fg:#0b1220; --shadow:0 6px 24px rgba(0,0,0,.5),0 2px 8px rgba(0,0,0,.4); }
    }
    *{box-sizing:border-box}
    body{margin:0; font:16px/1.65 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Apple Color Emoji","Segoe UI Emoji"; color:var(--fg); background:var(--bg)}
    .wrap{max-width:var(--maxw); margin:0 auto; padding:28px 18px 72px}
    header{display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom:22px}
    .brand h1{margin:0; font-size:26px}
    .brand p{margin:6px 0 0; color:var(--muted)}
    .btn{display:inline-block; padding:8px 14px; border-radius:10px; border:1px solid var(--border); text-decoration:none; color:var(--fg)}
    .btn:hover{border-color:var(--accent)}
    .btn.primary{background:var(--accent); color:var(--accent-fg); border-color:transparent}
    .card{background:var(--card); border:1px solid var(--border); border-radius:16px; padding:18px; box-shadow:var(--shadow)}
    .hr{height:1px; background:var(--border); margin:24px 0}
    .content :where(h1,h2,h3){scroll-margin-top:80px}
    .content img{max-width:100%; height:auto; border-radius:12px; border:1px solid var(--border)}
    .content pre{background:var(--card); padding:12px; border-radius:12px; overflow:auto; border:1px solid var(--border)}
    .grid{display:grid; gap:14px; grid-template-columns:repeat(auto-fill,minmax(240px,1fr))}
    .file{display:block; padding:14px; border-radius:14px; border:1px solid var(--border); background:var(--bg); text-decoration:none; color:inherit}
    .file:hover{border-color:var(--accent); box-shadow:var(--shadow); transform:translateY(-1px)}
    .file h3{margin:0 0 6px; font-size:16px}
    .file p{margin:0; color:var(--muted); font-size:13px}
    footer{margin-top:36px; color:var(--muted); font-size:14px}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <h1>Retail Net-Zero — Solar + PPA (CORE Markets)</h1>
        <p>Folder landing page • README rendered below • Quick links to files</p>
      </div>
      <div class="actions">
        <a class="btn" href="../">← Back to Portfolio</a>
      </div>
    </header>

    <!-- Quick links to files in this folder -->
    <section class="card">
      <h2 style="margin-top:0">Files in this folder</h2>
      <div class="grid" id="file-grid">
        <!-- Existing files -->
        <a class="file" href="https://liamdaviss.github.io/Portfolio/Projects/Retail-Net-Zero-Case-Study/README.md">
          <h3>README.md</h3>
          <p>Project summary & documentation (Markdown)</p>
        </a>
        <a class="file" href="https://liamdaviss.github.io/Portfolio/Projects/Retail-Net-Zero-Case-Study//Retail-Net-Zero-Case-Study.pptx">
          <h3>Retail-Net-Zero-Case-Study.pptx</h3>
          <p>Final presentation deck (PowerPoint)</p>
        </a>
        <!-- NEW: Direct links to files inside /Task -->
        <a class="file" href="https://liamdaviss.github.io/Portfolio/Projects/Retail-Net-Zero-Case-Study//Task/CORE_Markets_Intern_Analyst_Case_Study_2025.pdf">
          <h3>Task Outline — Brief</h3>
          <p>Official task brief (PDF)</p>
        </a>
        <a class="file" href="https://liamdaviss.github.io/Portfolio/Projects/Retail-Net-Zero-Case-Study//Task/CORE_Markets_Intern_Analyst_Case_Study_Data_2025.xlsx">
          <h3>Task Outline — Data</h3>
          <p>Raw dataset (Excel)</p>
        </a>
      </div>
    </section>

    <div class="hr"></div>

    <!-- README will be rendered here -->
    <section id="readme" class="content card">
      <noscript>
        <p><strong>Note:</strong> Enable JavaScript to view the rendered README. You can still open it directly:
          <a href="https://liamdaviss.github.io/Portfolio/Projects/Retail-Net-Zero-Case-Study/README.md">README.md</a>.</p>
      </noscript>
    </section>

    <footer>
      <div class="hr"></div>
      © <span id="year"></span> Liam Davis
    </footer>
  </div>

  <!-- Markdown renderer + sanitizer -->
  <script src="https://cdn.jsdelivr.net/npm/dompurify@3.1.7/dist/purify.min.js" integrity="sha256-5b1J2KfQZ8dG8t6o8l1Ww6h1b0yQ2k7a4w+0mZ2aY2k=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

  <script>
    // Footer year
    document.getElementById('year').textContent = new Date().getFullYear();

    // Fetch and render README.md from the same folder
    (async function renderReadme() {
      try {
        const res = await fetch('./README.md', { cache: 'no-store' });
        if (!res.ok) throw new Error('README not found in this folder');
        const md = await res.text();
        marked.setOptions({ breaks: true, mangle: false, headerIds: true });
        const html = marked.parse(md);
        document.getElementById('readme').innerHTML = DOMPurify.sanitize(html);

        // Normalize all links in the rendered README so they resolve under /REPO/... on Pages
        normalizeLinks('#readme');
      } catch (err) {
        document.getElementById('readme').innerHTML =
          '<p>Could not load README.md from this folder. You can open it directly: <a href="./README.md">README.md</a>.</p>';
        console.error(err);
      }
    })();

    // Ensure relative and root-relative links work regardless of project/profile site
    function normalizeLinks(scopeSelector) {
      var baseHref = document.querySelector('base')?.href || (window.location.origin + '/');
      var anchors = document.querySelectorAll(scopeSelector + ' a[href]');
      anchors.forEach(function (a) {
        var href = a.getAttribute('href') || '';
        // Skip external links and hash anchors
        if (/^[a-z]+:/i.test(href) || href.startsWith('#')) return;
        // URL-encode spaces
        href = href.replace(/ /g, '%20');
        if (href.startsWith('/')) {
          // Root-relative -> base + path (drop leading '/')
          a.setAttribute('href', new URL(href.slice(1), baseHref));
        } else {
          // Relative -> base + relative path
          if (href.startsWith('./')) href = href.slice(2);
          a.setAttribute('href', new URL(href, baseHref));
        }
      });
    }
  </script>
</body>
</html>